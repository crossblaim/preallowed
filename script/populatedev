#!/usr/bin/env ./script/runner 

preallowed = Client.create :name => "rootlocus", :id => 1
preallowed.save

preallowedScope = Scope.create :name => "rootlocus", :id => 1, :client_id => 1
preallowedScope.save

# add default resource_types types here
ResourceType.create(:name => "URL ResourceType").save
ResourceType.create(:name => "Printer ResourceType").save


Role.create(:id => 1, :name => "preallowed_admin", :client_id => 1).save

Subject.create(:id =>1, :name => "admin", :client_id => 1, :email => "dmitry@rootlocusinc.com").save

#add default principal types here   
plainPassword = PrincipalType.create :id => 1, :name => "hashed_password"
plainPassword.save

salt = PrincipalType.create :id => 2, :name => "salt"
salt.save


adminsPasswordPrincipal = 
    Principal.create :value => "35263a0f3aa0ea37b57027d3c9635725746644e3", 
    :principal_type_id      => 1, 
    :subject_id             => 1
adminsPasswordPrincipal.save
adminsSaltPrincipal     = 
    Principal.create :value => "291247300.585749468074609", 
    :principal_type_id      => 2, 
    :subject_id             => 1
adminsSaltPrincipal.save


    
Resource.create(:id => 1, :name => "^/.*$", :resource_type_id => 1, :scope_id => 1).save


Subject.find(1).roles << Role.find(1)


Resource.find(1).roles << Role.find(1)


# populate cleantogether related data

Client.create(:id => 2, :name => "cleantogether").save

Scope.create(:id => 2, :name => "cleantogether_dev", :client_id => 2).save

Role.create(:id => 2, :name => "user", :client_id => 2).save
Role.create(:id => 3, :name => "team captain", :client_id => 2).save
Role.create(:id => 4, :name => "admin", :client_id => 2).save

Role.create(:id => 5, :name => "cleantogether_rest", :client_id => 1).save

Subject.create(:id =>2, :name => "cleantogether_rest", :client_id => 1 , :email => "dmitry@rootlocusinc.com").save

adminsPasswordPrincipal = 
     Principal.create :id => 3,
     :value => "35263a0f3aa0ea37b57027d3c9635725746644e3", 
     :principal_type_id      => 1, 
     :subject_id             => 2
 adminsPasswordPrincipal.save
 adminsSaltPrincipal     = 
     Principal.create :id => 4,
     :value => "291247300.585749468074609", 
     :principal_type_id      => 2, 
     :subject_id             => 2
 adminsSaltPrincipal.save

 Resource.create(:id => 2, :name => "^/clients/2($|.xml$|/.*$)", :resource_type_id => 1, :scope_id => 1).save
 Resource.create(:id => 3, :name => "^/.*$", :resource_type_id => 1, :scope_id => 2).save

 Resource.find(2).roles << Role.find(5)         
 Subject.find(2).roles << Role.find(5)

 Resource.find(3).roles << Role.find(2)         
 Resource.find(3).roles << Role.find(3)         
 Resource.find(3).roles << Role.find(4)         

